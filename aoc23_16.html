<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script>
	"use strict";

	function calc() {
		document.getElementById("result").innerHTML = getResult();
	}

	function getResult() {
		const area = input.split("\n").map(line => line.split(""));

		const part1 = goBeam([0, 0, "R"].join(","), area);

		const allEnergizedTiles = [];

		for (let i = 0; i < area.length; ++i) {
			allEnergizedTiles.push(
				goBeam([i, 0, "R"].join(","), area),
				goBeam([i, area[i].length - 1, "L"].join(","), area),
				goBeam([0, i, "D"].join(","), area),
				goBeam([area.length - 1, i, "U"].join(","), area));
		}

		const part2 = Math.max(...allEnergizedTiles);

		return part1 + ", " + part2;
	}
	
	function goBeam(str, area) {
		const set = new Set();
		set.add(str);

		const energizedTiles = new Set();

		set.forEach(beam => {
			let [curY, curX, curDir] = beam.split(",");
			curY = +curY;
			curX = +curX;

			while (curY < area.length && curY > -1 && curX < area[curY].length && curX > -1) {
				energizedTiles.add([curY, curX].join(","));

				if (curDir == "R") {
					if (area[curY][curX] == "/") {
						--curY;
						curDir = "U";
					} else if (area[curY][curX] == "\\") {
						++curY;
						curDir = "D";
					} else if (area[curY][curX] == "|") {
						++curY;
						curDir = "D";

						if (!set.has([curY - 2, curX, "U"].join(","))) {
							set.add([curY - 2, curX, "U"].join(","));
						} else {
							curX = -1;
						}

					} else if (area[curY][curX] == "-" || area[curY][curX] == ".") {
						++curX;
					}

				} else if (curDir == "L") {
					if (area[curY][curX] == "/") {
						++curY;
						curDir = "D";
					} else if (area[curY][curX] == "\\") {
						--curY;
						curDir = "U";
					} else if (area[curY][curX] == "|") {
						++curY;
						curDir = "D";

						if (!set.has([curY - 2, curX, "U"].join(","))) {
							set.add([curY - 2, curX, "U"].join(","));
						} else {
							curX = -1;
						}

					} else if (area[curY][curX] == "-" || area[curY][curX] == ".") {
						--curX;
					}

				} else if (curDir == "U") {
					if (area[curY][curX] == "/") {
						++curX;
						curDir = "R";
					} else if (area[curY][curX] == "\\") {
						--curX;
						curDir = "L";
					} else if (area[curY][curX] == "-") {
						++curX;
						curDir = "R";

						if (!set.has([curY, curX - 2, "L"].join(","))) {
							set.add([curY, curX - 2, "L"].join(","));
						} else {
							curX = -1;
						}

					} else if (area[curY][curX] == "|" || area[curY][curX] == ".") {
						--curY;
					}

				} else if (curDir == "D") {
					if (area[curY][curX] == "/") {
						--curX;
						curDir = "L";
					} else if (area[curY][curX] == "\\") {
						++curX;
						curDir = "R";
					} else if (area[curY][curX] == "-") {
						++curX;
						curDir = "R";

						if (!set.has([curY, curX - 2, "L"].join(","))) {
							set.add([curY, curX - 2, "L"].join(","));
						} else {
							curX = -1;
						}

					} else if (area[curY][curX] == "|" || area[curY][curX] == ".") {
						++curY;
					}
				}
			}
		});

		return energizedTiles.size;
	}

const test = String.raw`.|...\....
|.-.\.....
.....|-...
........|.
..........
.........\
..../.\\..
.-.-/..|..
.|....-|.\
..//.|....`;

const input = String.raw`\...\............................../...\....-..../...|....../.......-...........................|.............
.............|/.../............................-....|......../...........|.|................/\-..|....\...../.
....\......-.....||-\........................|/........|............/.......................|\...|............
|.....-....\.|......-.\....\-......|.........../|......../\...\.-..........-.........\...-..\........./.......
............../.|..........|.......|.......\.\...............|../......................\......................
.-.-...|....-.-.......\...\..../....../.......-..................\......./....................-........-......
..........\.....|.....\.....\..................................................................|..............
...../..................../...........-..-.........................-...................................../-...
......\......\.............|..../..........\.........................\..\../....../...........-...........-...
.....|./..........-....\....|........./..........-..............-./........../..............-...\...../.......
...../...../.......-..............|......\\../......../........../............../......\......\...../........-
..\................|......\.............\|............./..../...-...........................|-../|...|......./
....|.........-.|....-....-.....|.......................................-...../.\.............\.........-.....
.........-........././................\../...........\.......\......./.....\................\...\.............
.............|........\....|........\........................././\............-............./............/....
................./...-..........|..............--../.|\............./.........................................
.|../.....|................|........../.......-.......-.............\.........................................
.............\..................\......../.......\/................\....\......../...././....................|
.................\................................../..........................................|..............
................|..................../..................\...........................|./..........-.........-..
...|.............\.....-..||...-......../.........................../......................-..-|.........-....
.\...........................-../................|.../............/....-......\............................../
.........................|...............|...........|.|.............\....\...../........-.--/................
./...|.........-.............|..-../..........\........./../...........................|.....................\
.|.....-......\..-..................\..|.../................................/\......-.........../...../..../..
...\...............\....\../.........|\................-......................................\...............
....../..-|...................................\.........|...-....|..../.......................|/..............
.........|.|..............-...................../.................|./-....|../..........\..............|......
.......\..|...\...........|....................|.-......................\..-.../.......\|..........\.../.|.\.|
-.............................|....................|.....|.........-.........|..-........./.......|\.|.../....
.-.......\...................\.....\../......|..............|...................-............./.....-.........
...|..................../..|\....\..-............\................\..................................|....-...
...............\....................\.|\....-.............|....../.................\..........\....../.....\..
......|..\......................-........\.......\.../.|......-...............|......./\../........../........
.........-..../........-\.........-.......-.....|.|....\.\........\.-.......|.........-....|...--.-..|........
.....|..|.|....-./.....|.....|...........|/\...../.............\/....|-........./..-.................../......
.|....../..............-...-............-.......-....................\..-...-.|...............................
|.............|............................|.............................-....................................
....../....-../..........\...|......-.|...........\..|..................-...../../-..\.........\.....|........
......\../..................-..............-.../.......-.............................\..-....\/...............
............\......................./..................|....-....................-........../.....-.......-...
...............|...........-./.......\...-..../....|....-........./..-.........-...........-.\................
/..................../.................\.....-................./\/........../............./..|................
....................../.............../\..........|.....\|../...-..\............|........./...................
......................-../.|...............................................-......./..\......|................
.......\...............|..............|.../............................\........./....|.....|................|
....\......../....-...|.................-..........-...|/./...................../.\...........................
.........|......./.............|../..-.......................-|...........\.........|...|.....................
..\............../.......................-....\.................-.....|.........-.............................
.....-/...............|......|..../......-...|..../...........-................................-.....\...\...\
......................../.......\................./..\..........\............|...................\............
-....................../...........\......./...|...........\|./........-..................\...-......../......
.......|./..........|...\................/..............|.\.............\.\..................................\
.|............\.......\..........\./..........-...................../..|............................../.......
........................../....../...|......-..\..............|-.|....\-...|../.........\......-.\./..........
....../.........../.........../..\......./......../-...\...........\............/.....................|...\...
...-....../.../.....\....-...........\..................../.........-......................\..................
/............|../.......................-.........|....../......|.......|............/-..../..../............|
../..|...............|../-................/.........................................|.........................
.....-..........-\-...........|....../\....................|......................-.....-..........\..........
.-.....\......./.....\............../...|...|............-...|...../.............\...\../|...../...|......../.
.../......-..|...................\-...../..-..|.......|..-..../........|....-.../.......|........|......|.....
.-....../............/........-/..........\........\...........................\..........................|...
.....|...|........................................../...........................-|.......|..-.................
|...........|.\..............|......................-|./.......|../....\-.|\.../...-.......|.......|..........
.|.........\.|../.....-.........\......\..\...........|...................\.........../......|.......-..../...
...............|.....................|......|.................../.............|.....-..|..........-...........
|.............|...........|............../......................\..........-.............|.....-..............
.\............-../\.................-.......|.-............../........\.......|.............\.....\...........
.../.\.....\|..-.............\.....................................|.................-............/..........|
.../../.............................-...|.......|..............-............................-.................
......................\-\............-......|.-............|.\...............-.../......\.........-...........
............................|..\.-.............../.\.../.......-..................\...........................
..../..\........-........\......../..\......../......\./..-|....|........\............|...................|\..
..................................................|...\..../........................................-.........
...\......-............\.......-...\...\............|\..../\....../.||........................................
...............-................-......-....../.../............................-.|....|................./..\..
......././../....-...................................................\..............................||........
|/.....\........./....................\......-.-.....|......|................../............................\.
................./..\...................\......\.........\..............-.....-....................\..-..../.\
...\......|..-.........-.....|.........-........|.............|..............\............-...................
.\..........|.............-............../../......../........................................................
....\....................................................-......../..-........|.....\..........\..............
.......-..\....................-..|.....-..../.-......../............\.............|..............|../........
...|/....-.............-......../\...........|................/..................\.....|....................-.
.....-................./.|......../..........-......|...\.....-..............-...-..|.......................|.
.........\..../...........-........|--......-.........-.........\...-.......|.\........-.........|.........../
........-...|../......../........\.....|.....|.....\................/.......-.....-.........../..|........\...
.-....\................||.......|...\..\......./.....-............|../...............|........./......-...-...
.......\......\............../.|.......................................|.......................|........./|...
............|../........-............................/.........-.........-..\..\..../.../.\...\.\.............
....................\...|.....\/...|\.|.................\.|...............................................\-..
.................\|...-........./\.......|.......................................-.........\..................
.......-.......|.............\....|...\.....-.\./.....-..................\\........-..\......-....../.........
............-...../....................|...-....../..............-..../................|...........-..........
............../\..........|........|./\\..|.....|../....-......../..............-............\......./...\....
............./....../......-...............\|..\............../......\.......................-.......|..-.....
.....-........./....\......................\...../...|./..\.../\...../.......\...............\............../.
...................................|..../../.-....................-.....-.......-...................-....-....
..................................................-......|-............|-...\.\...............\...............
.............../...........\................/.....\...........-.....|......................-............-.....
.............|.....|......................./.......|.............................\.|..........\../........\...
........................|..............\............................/...................-..|.......\.\........
.......|....../............/...............-..........|\.........|.......\.....|.............\/../...-...-....
......\.\.....-..||...-.\........\....|...../\/....\........../........|......|...............................
..\........-../....\/.....................-...........................|.......................................
..............|../.|...............\...\.........|..\............../......./.-.....\......-..../..............
....|....-............../......-.\........-............|.|..|.........................../.......|.............
........\............./...................|......../....|..-.....................|./.......\..................
............./.|...........\.............................../.....\....|/.......|.|........./.........|........`;

</script>
</head>
<body onload="calc()">
<div id="result"></div>
</body>
</html>